{{ define "main" }}

{{ $itemsPerPage := index $.Params "itemsPerPage" | default 5 }}
{{ $articlesSectionPath := printf "%s%s" .Dir "articles" }}
{{ $articles := $.Site.GetPage "section" $articlesSectionPath }}

{{ if $articles }}
{{ $paginator := .Paginate ($articles.Pages.ByDate.Reverse) $itemsPerPage }}
<section class="edge-spacer--h">

    <h1 class="page-title">{{ .Title }}</h1>
    {{ with $.Params.subtitle }}
    <p class="page-subtitle">{{ . }}</p>
    {{ end }}
    
    <div class="row-2-cols">
        <article class="col--left">
            <ul>
                {{ range $paginator.Pages }}
                <li>
                    {{ partial "components/article-preview.html" . }}
                </li>
                {{ end }}
            </ul>
            
            {{ partial "components/articles-list-nav.html" $paginator }}
        </article>
        
        {{ partial "components/blog-sidebar.html" . }}
    </div>
    
</section>
{{ end }}
{{ end }}
